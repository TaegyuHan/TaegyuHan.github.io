<style>
  /* 포스트 항목 포커스 스타일 */
  .archive__item--focused {
    outline: 2px solid #9198A1;
    outline-offset: 4px;
    border-radius: 4px;
    background-color: rgba(145, 152, 161, 0.08);
    transition: all 0.2s ease;
  }

  .list__item.archive__item--focused {
    outline: 2px solid #9198A1;
    outline-offset: 4px;
  }

  /* 포스트 리스트 키보드 탐색 힌트 */
  .post-nav-hint {
    position: fixed;
    bottom: 32px;
    left: 32px;
    z-index: 9999;
    background: #0f1116;
    color: #9ea7b3;
    border: 1px solid #20252e;
    border-radius: 12px;
    padding: 9px 14px;
    font-size: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.18);
    display: flex;
    align-items: center;
    gap: 12px;
    font-family: "Roboto", "Segoe UI", -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Lucida Grande", Arial, sans-serif;
    backdrop-filter: blur(6px);
    white-space: nowrap;
    opacity: 0.9;
  }

  .post-nav-hint__item {
    display: flex;
    align-items: center;
    gap: 6px;
    color: #c4c9d4;
  }

  .post-nav-hint__item:not(:last-child)::after {
    content: '·';
    margin-left: 6px;
    color: #7f8794;
  }

  .post-nav-hint kbd {
    background: #1b1f2a;
    border: 1px solid #2a3040;
    border-radius: 3px;
    padding: 2px 6px;
    font-size: 11px;
    font-family: monospace;
    box-shadow: 0 1px 2px rgba(0,0,0,0.12);
    color: #c4c9d4;
  }

  @media (max-width: 1280px) {
    .post-nav-hint {
      display: none;
    }
  }

  /* 페이지 알림 토스트 */
  .page-toast {
    position: fixed;
    bottom: 32px;
    left: 50%;
    transform: translateX(-50%);
    background: #0f1116;
    color: #c4c9d4;
    border: 1px solid #20252e;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 13px;
    font-family: "Roboto", "Segoe UI", -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Lucida Grande", Arial, sans-serif;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .page-toast--show {
    opacity: 1;
  }
</style>

<!-- 페이지 알림 토스트 -->
<div class="page-toast" id="page-toast"></div>

<script>
// 포스트 리스트 키보드 탐색
document.addEventListener('DOMContentLoaded', function() {
  // 홈 페이지가 아니면 실행하지 않음
  const isHomePage = document.querySelector('.entries-list') || document.querySelector('.entries-grid');
  if (!isHomePage) return;

  console.log('[Post Nav] Initializing post list keyboard navigation');

  let currentFocusIndex = 0;
  let postItems = [];
  let toastTimeout = null;
  
  // 토스트 메시지 표시
  function showToast(message) {
    const toast = document.getElementById('page-toast');
    if (!toast) return;

    toast.textContent = message;
    toast.classList.add('page-toast--show');

    if (toastTimeout) {
      clearTimeout(toastTimeout);
    }

    toastTimeout = setTimeout(function() {
      toast.classList.remove('page-toast--show');
    }, 2000);
  }
  
  // 포스트 항목 수집
  function updatePostItems() {
    // list__item 또는 grid__item을 찾음
    postItems = Array.from(document.querySelectorAll('.list__item, .grid__item'));
    console.log('[Post Nav] Found', postItems.length, 'post items');
  }

  // 포스트에 포커스
  function focusPost(index) {
    if (postItems.length === 0) return;

    // 인덱스 범위 제한
    if (index < 0) index = 0;
    if (index >= postItems.length) index = postItems.length - 1;

    // 이전 포커스 제거
    postItems.forEach(item => item.classList.remove('archive__item--focused'));

    // 새 포커스 적용
    currentFocusIndex = index;
    const focusedItem = postItems[currentFocusIndex];
    focusedItem.classList.add('archive__item--focused');
    
    // 스크롤하여 화면에 표시
    focusedItem.scrollIntoView({
      behavior: 'smooth',
      block: 'center'
    });
  }

  // 현재 포커스된 포스트 열기
  function openCurrentPost() {
    if (postItems.length === 0) return;
    
    const focusedItem = postItems[currentFocusIndex];
    const link = focusedItem.querySelector('a[rel="permalink"]');
    if (link) {
      window.location.href = link.href;
    }
  }

  // 페이지네이션 버튼 찾기
  function getPagenationLinks() {
    const pagination = document.querySelector('.pagination');
    if (!pagination) return { prev: null, next: null };

    const links = pagination.querySelectorAll('a');
    let prevLink = null;
    let nextLink = null;

    links.forEach(link => {
      const text = link.textContent.trim();
      if (text === 'Previous' || text === '이전' || text.includes('Previous')) {
        if (!link.classList.contains('disabled')) {
          prevLink = link;
        }
      } else if (text === 'Next' || text === '다음' || text.includes('Next')) {
        if (!link.classList.contains('disabled')) {
          nextLink = link;
        }
      }
    });

    return { prev: prevLink, next: nextLink };
  }

  // 초기화
  updatePostItems();
  
  // 키보드 이벤트 처리
  document.addEventListener('keydown', function(e) {
    // 입력 필드에서는 작동하지 않음
    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
    
    // 모달이 열려있으면 작동하지 않음
    if (document.querySelector('.toc-modal--active') || document.querySelector('.search-content')) return;

    switch(e.key) {
      case 'ArrowDown':
        e.preventDefault();
        focusPost(currentFocusIndex + 1);
        break;
      
      case 'ArrowUp':
        e.preventDefault();
        focusPost(currentFocusIndex - 1);
        break;
      
      case 'Enter':
        e.preventDefault();
        openCurrentPost();
        break;
      
      case 'ArrowLeft':
        e.preventDefault();
        const { prev } = getPagenationLinks();
        if (prev) {
          window.location.href = prev.href;
        } else {
          showToast('첫 페이지입니다');
        }
        break;
      
      case 'ArrowRight':
        e.preventDefault();
        const { next } = getPagenationLinks();
        if (next) {
          window.location.href = next.href;
        } else {
          showToast('마지막 페이지입니다');
        }
        break;
    }
  });

  console.log('[Post Nav] Keyboard navigation initialized');
});
</script>
